<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chat · Blossom & Blade</title>
<style>
  :root{--ink:#e9e9ff;--bg:#0b0b10;--chip:#a98bff;}
  *{box-sizing:border-box} body{margin:0;background:#0b0b10;color:#e9e9ff;font:16px/1.45 system-ui,Segoe UI,Roboto,Helvetica,Arial}
  header{padding:18px 20px; display:flex; align-items:center; gap:10px}
  .dot{width:10px;height:10px;border-radius:50%;background:#b98bff;box-shadow:0 0 12px #b98bff}
  h1{font-size:20px;margin:0}

  .hero{position:relative; height:180px; background:#111}
  .hero::before{content:"";position:absolute;inset:0;background:var(--bgimg) center/cover no-repeat;filter:brightness(.55)}
  .hero .shade{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.25),rgba(0,0,0,.6))}
  .hero .title{position:absolute;left:20px;bottom:16px;font-size:28px;font-weight:800}

  .wrap{max-width:900px;margin:-60px auto 60px; padding:0 16px}
  .panel{background:#0e0f14;border-radius:18px;box-shadow:0 10px 28px rgba(0,0,0,.35); padding:14px; height:60vh; overflow:auto}
  .bubble{max-width:74%; margin:12px 0; padding:14px 16px; border-radius:14px}
  .bubble.you{margin-left:auto;background:linear-gradient(180deg,#b78cff,#8e69ff); color:white}
  .bubble.him{background:#121521; color:#e9eaff}
  form{display:flex; gap:10px; margin-top:12px}
  textarea{flex:1; background:#0f1118; color:#e9eaff; border:1px solid #22243a;border-radius:12px;padding:12px 14px; resize:none; height:48px}
  button{background:#b38bff;color:#121225;border:0;border-radius:12px;padding:12px 18px;font-weight:700;cursor:pointer}
  .admin{position:fixed; right:18px; bottom:18px; background:#15a36e; color:#00140b; font-weight:800}
  .note{opacity:.7; font-size:12px; margin:6px 2px}
  /* kill any counters */
  .free-left,.trial-badge,#trialBadge{display:none!important}
</style>
<script>
  const BG = {
    alexander: "url('/images/boardroom.jpg')",
    dylan:     "url('/images/neon.jpg')",
    jesse:     "url('/images/rodeo.jpg')",
    grayson:   "url('/images/redroom.jpg')",
    silas:     "url('/images/stage.jpg')",
    blade:     "url('/images/forest.jpg')"
  };
  const MAN_LABEL = {
    alexander: "Alexander Jackson",
    dylan: "Dylan Vale",
    jesse: "Jesse Granger",
    grayson: "Grayson Kincaid",
    silas: "Silas Lennox",
    blade: "Blade Kincaid"
  };
  const q = new URLSearchParams(location.search);
  const man = (q.get('man') || 'jesse').toLowerCase();
  document.documentElement.style.setProperty('--bgimg', BG[man] || BG.jesse);
  document.title = MAN_LABEL[man] + " — Blossom & Blade";
</script>
</head>
<body>
  <header><span class="dot"></span><h1>Blossom & Blade</h1></header>

  <section class="hero"><div class="shade"></div>
    <div class="title" id="title"></div>
  </section>

  <div class="wrap">
    <div class="panel" id="log"></div>
    <div class="note">PG-13 by default. After-hours unlocks explicit talk — pricing page.</div>
    <form id="form">
      <textarea id="say" placeholder="Say hi…"></textarea>
      <button type="submit">Send</button>
    </form>
  </div>

  <a class="admin" href="/pay.html">Admin / Pricing</a>

  <script src="/scripts/brain.js"></script>
  <script>
    document.getElementById('title').textContent = MAN_LABEL[man] || 'Chat';
    const log = document.getElementById('log');
    const form = document.getElementById('form');
    const say = document.getElementById('say');

    function bubble(who, text){
      const b = document.createElement('div');
      b.className = 'bubble ' + (who==='you'?'you':'him');
      b.textContent = text;
      log.appendChild(b);
      log.scrollTop = log.scrollHeight;
    }

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const text = (say.value||'').trim();
      if(!text) return;
      bubble('you', text);
      say.value = '';
      const reply = await compose(text);
      bubble('him', reply);
    });

    say.addEventListener('keydown', e=>{
      if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); form.requestSubmit(); }
    });
  </script>
</body>
</html>
