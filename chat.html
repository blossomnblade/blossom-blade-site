<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Blossom & Blade — Chat</title>
  <link rel="icon" href="/images/logo.jpg"/>
  <!-- Mobile-ready styles -->
  <link rel="stylesheet" href="/styles/chat.css">
</head>
<body>
  <div class="pill">Adults 18+ only</div>

  <div class="wrap">
    <div class="chat" id="chat">
      <div class="msg opener" data-chat-opener>…</div>
    </div>
  </div>

  <div class="inputbar">
    <div class="row">
      <input id="chat-input" placeholder="Say hi…" autocomplete="off" />
      <button id="chat-send">Send</button>
    </div>
  </div>

  <!-- iOS keyboard & safe scroll helper -->
  <script>
    (function(){
      const chat = document.getElementById('chat');
      const input = document.getElementById('chat-input');
      function toBottom(){ if(chat) chat.scrollTop = chat.scrollHeight; }
      ['focus','blur','input'].forEach(ev=>{
        window.addEventListener(ev, toBottom, { passive:true });
        if(input) input.addEventListener(ev, toBottom, { passive:true });
      });
      window.addEventListener('resize', toBottom, { passive:true });
    })();
  </script>

  <!-- Script order matters: brain -> prompts -> moderation -> chat -->
  <script src="/scripts/brain.js"></script>
  <script src="/scripts/prompts.js"></script>   <!-- depth + pacing -->
  <script src="/scripts/mod.js"></script>       <!-- strike logging -->
  <script src="/scripts/chat.js"></script>      <!-- wiring -->
</body>
</html>
