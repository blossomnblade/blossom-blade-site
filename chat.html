<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Blossom &amp; Blade — Chat</title>
  <link rel="icon" href="/images/logo.jpg">

  <!-- Your existing global/chat CSS (keep if you have it) -->
  <!-- <link rel="stylesheet" href="/styles/site.css"> -->

  <!-- New background + portrait hardening -->
  <link rel="stylesheet" href="/styles/bg.css">

  <!-- Minimal safety styles so the page looks right even without site.css -->
  <style>
    :root{--card:#101728;--ink:#e5eef7;--inkdim:#9fb0c5;--accent:#ff6b9e;}
    *{box-sizing:border-box}
    body{margin:0;color:var(--ink);font:16px/1.45 system-ui,Segoe UI,Inter,Roboto,Arial,sans-serif}
    .wrap{max-width:1200px;margin:24px auto;padding:0 16px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    h1{margin:0;font-size:40px}
    .badges{display:flex;gap:12px}
    .badge{background:#0b1220;padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.1);color:var(--ink)}
    .grid{display:grid;gap:28px;grid-template-columns:1fr 2fr}
    .card{background:rgba(16,23,40,.85);border:1px solid rgba(255,255,255,.08);border-radius:20px;padding:16px;box-shadow:0 0 40px rgba(255,0,120,.08)}
    #bubbles{height:64vh;overflow:auto}
    .inputRow{display:flex;gap:12px;margin-top:12px}
    #input{flex:1;padding:14px 16px;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:#0b1220;color:var(--ink)}
    #sendBtn{background:var(--accent);color:#fff;padding:12px 18px;border:none;border-radius:14px;font-weight:600;cursor:pointer}
    #portraitCaption{opacity:.8;margin-top:8px;font-size:14px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>

  <div class="wrap">
    <header>
      <h1>Blossom &amp; Blade —</h1>
      <div class="badges">
        <span class="badge" id="redBadge">RED</span>
        <span class="badge">Adults 18+ only</span>
      </div>
    </header>

    <section class="grid">
      <!-- Portrait column -->
      <aside class="card">
        <div id="portrait" class="portrait">
          <img id="portraitImg" alt="portrait" loading="eager" />
        </div>
        <div id="portraitCaption"></div>
      </aside>

      <!-- Chat column -->
      <main class="card">
        <div id="bubbles" class="chat-scroll" aria-live="polite"></div>
        <div class="inputRow">
          <input id="input" type="text" placeholder="Say something..." autocomplete="off">
          <button id="sendBtn">Send</button>
        </div>
      </main>
    </section>
  </div>

  <!-- AUTO-PORTRAIT LOADER (matches your repo filenames) -->
  <script>
    (function () {
      const p = new URLSearchParams(location.search);
      const man = (p.get('man') || 'viper').toLowerCase();
      const portraits = {
        blade:     '/images/characters/blade/blade-chat.webp',
        dylan:     '/images/characters/dylan/dylan-chat.webp',
        grayson:   '/images/characters/grayson/grayson-chat.webp',
        silas:     '/images/characters/silas/silas-chat.webp',
        alexander: '/images/characters/alexander/alexander-chat.webp',
        viper:     '/images/characters/viper/viper-chat.webp',
        default:   '/images/characters/viper/viper-chat.webp'
      };
      const captions = {
        blade:'Blade — portrait', dylan:'Dylan — portrait', grayson:'Grayson — portrait',
        silas:'Silas — portrait', alexander:'Alexander — portrait', viper:'Viper — portrait'
      };
      const img = document.getElementById('portraitImg');
      const cap = document.getElementById('portraitCaption');
      const src = portraits[man] || portraits.default;
      img.src = src;
      cap.textContent = captions[man] || '— portrait';
      img.onerror = () => { img.removeAttribute('src'); cap.textContent = ''; };
    })();
  </script>

  <!-- NEW: per-guy background switcher -->
  <script src="/scripts/bg.js" defer></script>

  <!-- YOUR EXISTING CHAT APP (keep this exactly as in your repo) -->
  <script src="/scripts/chat.js" defer></script>
</body>
</html>
