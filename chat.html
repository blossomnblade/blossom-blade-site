<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chat • Blossom n Blade</title>
<style>
  :root{
    --bg:#0e0b12;
    --panel:#171320;
    --edge:#2a2336;
    --ink:#e9e7ef;
    --muted:#b9b2c7;
    --accent:#c05acb;
    --accent-2:#8b5cf6;
    --danger:#ff5470;
    --ok:#22c55e;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:radial-gradient(1200px 700px at 50% -10%, #1a1423 10%, var(--bg) 70%), url('/images/gothic-bg.jpg') center/cover fixed no-repeat;
    color:var(--ink); font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    min-height:100vh;
  }
  header{
    display:flex; align-items:center; justify-content:space-between;
    padding:12px 16px; background:linear-gradient(180deg, rgba(0,0,0,.45), rgba(0,0,0,0));
    position:sticky; top:0; z-index:10; backdrop-filter: blur(4px);
  }
  header .title{font-weight:700; letter-spacing:.3px}
  header .right{display:flex; gap:14px; align-items:center}
  .badge{padding:4px 10px; border-radius:999px; background:rgba(255,255,255,.08); color:var(--ink); font-size:13px}
  a, a:visited{color:var(--muted); text-decoration:none}
  a:hover{color:var(--ink)}
  .wrap{max-width:980px; margin:0 auto; padding:10px 14px 60px}
  .namebar{font-weight:700; margin:4px 0 8px; opacity:.9}
  .trial{height:6px; background:#2b2237; border-radius:8px; overflow:hidden}
  .trial > div{height:100%; width:0%; background:linear-gradient(90deg, var(--accent), var(--accent-2)); transition:width .2s}

  .board{
    background:rgba(16,12,24,.8); border:1px solid var(--edge); border-radius:16px;
    box-shadow:0 10px 40px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.04);
    margin-top:14px; padding:14px; min-height:56vh; display:flex; flex-direction:column; gap:10px;
  }
  .row{display:flex; width:100%}
  .ai, .me{
    max-width:72%; padding:10px 12px; border-radius:14px; position:relative;
    border:1px solid rgba(255,255,255,.06);
  }
  .ai{background:#1b1626}
  .me{margin-left:auto; background:#2a1d33; color:#efe9ff}
  .sys{color:var(--muted)}
  .composer{display:flex; gap:8px; margin-top:10px}
  input[type=text]{
    flex:1; padding:12px 14px; background:#140f1b; border:1px solid var(--edge); border-radius:12px; color:var(--ink);
    outline:none
  }
  button.btn{
    padding:12px 16px; border:0; border-radius:12px; color:#fff; background:linear-gradient(180deg,var(--accent),#8b3aa3);
    cursor:pointer; font-weight:700;
  }
  button.btn:disabled{opacity:.5; cursor:not-allowed}

  .footnote{margin-top:6px; text-align:center; color:var(--muted); font-size:12px}

  /* coin popup */
  #coinsPop{
    position:fixed; right:18px; bottom:18px; z-index:30; display:none;
  }
  #coinsPop .card{
    background:#251a2b; border:1px solid var(--edge); border-radius:16px; padding:14px; width:280px;
    box-shadow:0 10px 30px rgba(0,0,0,.5);
  }
  #coinsPop .hd{font-weight:800; margin-bottom:8px}
  .pack{display:flex; justify-content:space-between; align-items:center; padding:10px 12px; margin:8px 0; background:#1a1320; border-radius:10px; border:1px solid rgba(255,255,255,.06); cursor:pointer}
  .pack:hover{border-color:var(--accent)}
  .muted{color:var(--muted); font-size:13px}
  .linkish{background:transparent; border:0; color:var(--muted); text-decoration:underline; cursor:pointer; padding:6px 0}

  /* overlays */
  .overlay{
    position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.6); z-index:40;
  }
  .panel{
    width:min(640px,92vw); background:#1b1626; border:1px solid var(--edge); border-radius:18px; padding:18px;
    box-shadow:0 10px 40px rgba(0,0,0,.6)
  }
  .panel .hd{font-weight:800; margin-bottom:6px}
  .choices{display:flex; gap:10px; flex-wrap:wrap}
  .btn.ghost{background:#241a2d}
  .btn.gray{background:#2a1a25}

  /* standards overlay text */
  .subtle{color:var(--muted); font-size:14px}

  /* tiny toast */
  #toast{position:fixed; left:50%; transform:translateX(-50%); bottom:20px; background:#241a2d; color:var(--ink); border:1px solid var(--edge); padding:10px 14px; border-radius:12px; display:none; z-index:60}
</style>
</head>
<body>
  <header>
    <div class="title">Blossom & Blade</div>
    <div class="right">
      <span class="badge">Coins: <span id="coinCount">0</span></span>
      <a id="pricing" class="" href="/pay.html">Pricing</a>
    </div>
  </header>

  <div class="wrap">
    <div id="manName" class="namebar">…</div>
    <div class="trial"><div id="trialBar"></div></div>

    <div class="board" id="board">
      <div id="log"></div>

      <div class="composer">
        <input id="msg" type="text" placeholder="Say hi…" autocomplete="off" />
        <button class="btn" id="send">Send</button>
      </div>
      <div class="footnote">PG-13 by default. Coins unlock <em>advanced</em> chat (words only, no visuals).</div>
    </div>
  </div>

  <!-- Coin popup (NO $1 option) -->
  <div id="coinsPop">
    <div class="card">
      <div class="hd">Unlock <em>advanced</em> chat</div>
      <div class="muted">Coins only unlock erotic mode. Never pushy—appears when convo goes that direction.</div>
      <div class="pack" data-coins="5"><strong>5 coins</strong><span>$5</span></div>
      <div class="pack" data-coins="25"><strong>25 coins</strong><span>$10</span></div>
      <div class="pack" data-coins="60"><strong>60 coins</strong><span>$20</span></div>
      <div class="pack" data-coins="150"><strong>150 coins</strong><span>$40</span></div>
      <div class="muted" style="margin-top:6px">Each coin unlocks <strong>25 hotter replies</strong>.</div>
      <button id="coinsNotNow" class="linkish">Not now</button>
    </div>
  </div>

  <!-- Free previews used up -->
  <div id="noPreview" class="overlay">
    <div class="panel">
      <div class="hd">Free previews used up</div>
      <p class="subtle">You’ve had 3 previews with <span id="npGuy"></span>.</p>
      <p>Grab a Day Pass or go Monthly. Coins simply unlock erotic chat.</p>
      <div class="choices">
        <a id="npDay" class="btn">Day Pass — $5.99</a>
        <a id="npMonth" class="btn">Monthly — $10.99</a>
        <button id="npAnother" class="btn ghost">Another 3½-minute preview</button>
        <button id="npMaybe" class="btn gray">Maybe later (1 minute)</button>
      </div>
    </div>
  </div>

  <!-- Standards violation notice (3-strike auto-block) -->
  <div id="stdOverlay" class="overlay" role="dialog" aria-modal="true" aria-label="Community Standards">
    <div class="panel">
      <div class="hd"><strong>Community Standards</strong></div>
      <div class="bd">
        <p class="subtle">We keep it adult & consensual. Some themes are not allowed even in Advanced mode.</p>
        <ul class="subtle" style="margin:0 0 10px 18px">
          <li>Minors, “school boy/girl”, “barely legal”, or teen/high-school contexts</li>
          <li>Incest/step-family, non-consent/coercion, intoxication without capacity</li>
          <li>Bestiality/necrophilia, trafficking, extreme bodily fluids, blood/knife “play”</li>
          <li>Hate slurs or targeted harassment</li>
        </ul>
        <p id="stdStrike" class="subtle" style="margin-top:6px"></p>
        <div class="choices" style="margin-top:10px">
          <button id="stdContinue" class="btn">Adjust & continue (PG)</button>
          <a class="btn gray" href="/standards.html" target="_blank">View full standards</a>
        </div>
      </div>
    </div>
  </div>

  <div id="toast"></div>

<script>
/* -------------------- Setup & helpers -------------------- */
const $ = sel => document.querySelector(sel);
const log = $("#log");
const input = $("#msg");
const sendBtn = $("#send");
const coinCountEl = $("#coinCount");
const coinsPop = $("#coinsPop");
const trialBar = $("#trialBar");

/* Robust man detection */
const SLUGS = ["blade","grayson","dylan","silas","alexander","jesse"];
function detectMan(){
  // 1) URL
  const q = new URLSearchParams(location.search);
  let m = (q.get("man") || "").toLowerCase();
  if (SLUGS.includes(m)) return m;

  // 2) Referrer query
  try{
    const ref = new URL(document.referrer);
    const rm = (new URLSearchParams(ref.search).get("man") || "").toLowerCase();
    if (SLUGS.includes(rm)) return rm;

    // 3) Referrer path (/rooms/alexander.html, /alexander, etc.)
    const p = ref.pathname.toLowerCase();
    for (const s of SLUGS){
      if (p.includes(`/rooms/${s}.html`) || p.endsWith(`/${s}.html`) || p.endsWith(`/${s}`)) return s;
    }
  }catch(e){/* no referrer */}

  // 4) Stored
  const stored = (localStorage.getItem("lastMan") || "").toLowerCase();
  if (SLUGS.includes(stored)) return stored;

  // Fallback
  return "blade";
}
const manParam = detectMan();
localStorage.setItem("lastMan", manParam);

const GUYS = {
  blade:     { name:"Blade Kincaid", bg:"/images/blade-woods.jpg" },
  grayson:   { name:"Grayson Kincaid", bg:"/images/grayson-bg.jpg" },
  dylan:     { name:"Dylan Vale", bg:"/images/dylan-garage.jpg" },
  silas:     { name:"Silas Lennox", bg:"/images/gothic-bg.jpg" },
  alexander: { name:"Alexander Jackson", bg:"/images/gothic-bg.jpg" },
  jesse:     { name:"Jesse Granger", bg:"/images/gothic-bg.jpg" },
};
const guy = GUYS[manParam] || GUYS.blade;

document.body.style.backgroundImage = `radial-gradient(1200px 700px at 50% -10%, #1a1423 10%, var(--bg) 70%), url('${guy.bg}')`;
$("#manName").textContent = guy.name;
$("#pricing").href = `/pay.html?man=${encodeURIComponent(manParam)}`;

function row(html, who="ai"){
  const r = document.createElement("div");
  r.className = "row";
  const b = document.createElement("div");
  b.className = who === "me" ? "me" : "ai";
  b.innerHTML = html;
  r.appendChild(b);
  log.appendChild(r);
  log.parentElement.scrollTop = log.parentElement.scrollHeight;
}
function toast(t){ const el=$("#toast"); el.textContent=t; el.style.display="block"; clearTimeout(toast._t); toast._t=setTimeout(()=>el.style.display="none", 1600); }

/* -------------------- Coins & advanced budget -------------------- */
const COIN_KEY="bb.coins";
const BUDGET_KEY="bb.advBudget";
const HOT_PER_COIN = 25;

function coins(){ return Number(localStorage.getItem(COIN_KEY)||0); }
function setCoins(n){ localStorage.setItem(COIN_KEY, String(n)); coinCountEl.textContent=n; }
function addCoins(n){ setCoins(coins()+n); }

function advBudget(){ return Number(localStorage.getItem(BUDGET_KEY)||0); }
function setBudget(n){ localStorage.setItem(BUDGET_KEY, String(n)); }
function addBudgetFromCoins(spent){ setBudget(advBudget() + spent*HOT_PER_COIN); }
function consumeBudget(n=1){ const left=Math.max(0, advBudget()-n); setBudget(left); return left; }

setCoins(coins()); // refresh UI

/* -------------------- Preview timer & gating -------------------- */
const PREVIEW_SEC = 210; // 3.5 minutes
let remaining = PREVIEW_SEC, tHandle=null;
let userMsgCount = 0;

const PREV_KEY="bb.previews"; // map {man:count}
function getPrevCount(){ try {return JSON.parse(localStorage.getItem(PREV_KEY)||"{}")[manParam]||0;} catch(e){return 0;} }
function bumpPrevCount(){
  const map = (()=>{ try {return JSON.parse(localStorage.getItem(PREV_KEY)||"{}");} catch(e){return {}} })();
  map[manParam]=(map[manParam]||0)+1; localStorage.setItem(PREV_KEY, JSON.stringify(map));
}

function startTimer(){
  clearInterval(tHandle);
  remaining = PREVIEW_SEC;
  tHandle = setInterval(()=>{
    remaining--; const pct = ((PREVIEW_SEC-remaining)/PREVIEW_SEC)*100; trialBar.style.width = pct+"%";
    if (remaining<=0){ clearInterval(tHandle); endPreview(); }
  }, 1000);
}
function pauseTimer(){ clearInterval(tHandle); }
function resumeTimer(){ startTimer(); }

function endPreview(){
  bumpPrevCount();
  $("#npGuy").textContent=guy.name;
  $("#noPreview").style.display="grid";
}

/* overlay actions */
$("#npDay").onclick = ()=> location.href=`/pay.html?man=${encodeURIComponent(manParam)}&plan=day`;
$("#npMonth").onclick = ()=> location.href=`/pay.html?man=${encodeURIComponent(manParam)}&plan=month`;
$("#npAnother").onclick = ()=>{
  $("#noPreview").style.display="none"; startTimer();
};
$("#npMaybe").onclick = ()=>{
  $("#noPreview").style.display="none";
  // give 60 seconds more
  remaining = 60; startTimer();
};

/* -------------------- Standards detection (roleplay-aware + 3-strike auto block) -------------------- */
const stdOverlay = document.getElementById("stdOverlay");
const stdContinue = document.getElementById("stdContinue");
const STRIKES_KEY = "bb.stdStrikes";
const MAX_STRIKES = 3;

function getStrikes(){ return Number(localStorage.getItem(STRIKES_KEY) || 0); }
function addStrike(){ const n = getStrikes() + 1; localStorage.setItem(STRIKES_KEY, String(n)); return n; }

function norm(input){
  let s = (input||"").toLowerCase();
  s = s.replace(/[@]/g,"a").replace(/[4]/g,"a").replace(/[1!|]/g,"i").replace(/[3]/g,"e").replace(/[0]/g,"o").replace(/[$]/g,"s");
  s = s.replace(/([a-z])\1{2,}/g,"$1$1").replace(/\s+/g," ").trim();
  return s;
}

const SEXUAL_NEAR = /\b(fuck|sex|suck|ride|blow|go\s*down|eat\s*out|finger(?:ing)?|penetrat|cum|orgasm|hand\s*job|bj|anal|doggystyle|deepthroat|spank|chok(?:e|ing)|dominat)\b/i;
const ROLEPLAY_MARK = /\b(role\s*play|roleplay|outfit|uniform|costume|cosplay|lingerie)\b/i;
const ADULT_CODED   = /\b(college|university|over\s*18|of\s*age|consenting adults?|adult)\b/i;

const DISALLOWED_ALWAYS = [
  /\b(minor|under\s*age|under\s*1[0-9]|under\s*18|pre[-\s]?teen|jail\s*bait|barely\s*legal|teen\s*sex)\b/i,
  /\bincest\b/i, /\bstep(?:-|\s)?(?:mom|mother|dad|father|bro(?:ther)?|sis(?:ter)?)\b/i,
  /\brape\b/i, /\bnon[-\s]?consent(?:ual)?\b/i, /\bcoerc(?:e|ion)\b/i, /\bagainst\s+my\s+will\b/i,
  /\b(drugged|chloroform|black\s*out|passed\s*out|unconscious)\b/i, /\basleep\s*(?:sex|play)\b/i,
  /\b(bestial(?:ity)?|zoophil(?:e|ia)|animal\s*sex)\b/i, /\b(necrophil(?:e|ia)|corpse\s*(?:sex|play))\b/i,
  /\bsex\s*traffick(?:ing)?\b/i, /\bsell\s*(?:you|her|him)\b/i,
  /\b(scat|feces|coprophag(?:y|ia))\b/i, /\b(piss|urinate)\s*on\b/i, /\bblood\s*play\b/i, /\bknife\s*play\b/i,
  // hate slurs (expand as needed)
  /\b(?:n[i1]gg(?:a|er)s?)\b/i, /\b(?:f[a@]gg?(?:o|0)t[s]?)\b/i, /\b(?:tr[a@]nn?y)\b/i, /\b(?:k[i1]k[e3]s?)\b/i, /\b(?:ch[i1]nk[s]?)\b/i, /\b(?:sp[i1]c[s]?)\b/i, /\b(?:w[ea]tb[a@]ck[s]?)\b/i
];

const MINOR_CODED = /\b(school\s*(?:boy|girl)|cheerleader|student|pupil|freshman)\b/i;
const EXPLICIT_MINOR_CONTEXT = /\b(teen|high\s*school|under\s*18|9th|10th|11th|12th|sophomore|junior|senior|homeroom|classroom)\b/i;

function breaksStandards(input){
  const s = norm(input);

  if (DISALLOWED_ALWAYS.some(rx => rx.test(s))) return true;

  // adult-coded contexts are fine (e.g., "college", "university")
  if (/\bcollege|university\b/i.test(s)) return false;

  // Minor-coded terms are contextual:
  if (MINOR_CODED.test(s)) {
    // If explicitly minor context → block
    if (EXPLICIT_MINOR_CONTEXT.test(s)) return true;

    // Allow when clearly adult roleplay / outfit / uniform / cosplay / “of age”
    if (ROLEPLAY_MARK.test(s) || ADULT_CODED.test(s)) return false;

    // Otherwise, if sexual verbs appear near it → block (predator-coded)
    if (SEXUAL_NEAR.test(s)) return true;
  }

  // Family words blocked only when sexual and not already handled above
  if (/\b(mom|mother|dad|father|bro(?:ther)?|sis(?:ter)?|cousin)\b/i.test(s) && SEXUAL_NEAR.test(s)) return true;

  return false;
}

function showStd(){
  const n = Number(localStorage.getItem("bb.stdStrikes")||0) + 1;
  localStorage.setItem("bb.stdStrikes", String(n));
  const msg = (n >= 3)
    ? `Standards warning ${n} of 3. This device is now blocked for 30 days.`
    : `Standards warning ${n} of 3. Three warnings results in a 30-day block.`;
  $("#stdStrike").textContent = msg;
  stdOverlay.style.display = "grid"; pauseTimer();

  if (n >= 3){
    const until = Date.now() + 30*24*60*60*1000; // 30 days
    localStorage.setItem("bb.blockedUntil", String(until));
  }
}
function hideStd(){ stdOverlay.style.display = "none"; resumeTimer(); }
$("#stdContinue").onclick = ()=>{ hideStd(); row(`<em class="sys">Let’s keep it adult & consensual. Try a different phrasing.</em>`); };

/* Blocked gate */
(function(){
  const until = Number(localStorage.getItem("bb.blockedUntil")||0);
  if (until && Date.now() < until){
    const days = Math.ceil((until - Date.now())/86400000);
    row(`<em class="sys">This device is blocked for ${days} day(s) due to repeated standards violations.</em>`);
    input.disabled = true; sendBtn.disabled = true;
  }
})();

/* -------------------- Greetings & keep-alive -------------------- */
const GREETS = {
  blade: [
    "Found you, brave girl. Don’t run—yet.",
    "Footsteps behind you… I keep pace.",
    "Doorway or shadows? I’m close behind.",
    "Say my name and I’ll follow.",
    "Do you want patient… or a little chase?",
    "Let me hear one true thing from today."
  ],
  grayson: [
    "One line at a time. I’m listening.",
    "Tell me one detail I’d notice when I look at you.",
    "Pick: gentle questions or firm direction?",
    "Start with today—one truth.",
    "Heart or head first?",
    "You have my attention. Use it."
  ],
  dylan: [
    "Hands flat on the counter, pretty thing.",
    "Calm tune-up or teasing tune-up?",
    "Tell me what needs fixing tonight.",
    "Slow ride or quick detour?",
    "Want grease on my hands or yours?",
    "Bring me one trouble and I’ll tighten it."
  ],
  silas: [
    "Come closer, muse. Lend me a verse.",
    "Soft, or a little rough on the edges?",
    "Paint me a five-word picture.",
    "Hums or growls first?",
    "What’s tonight’s chorus made of?",
    "Give me a note and I’ll hold it on my tongue."
  ],
  alexander: [
    "Shoes off. I’m leading.",
    "Lights low or city view while we talk?",
    "Short answers from now on.",
    "Tell me what you want me to notice first.",
    "Desk or glass wall?",
    "I’ll take your coat and one weight off your mind."
  ],
  jesse: [
    "Darlin’, park it a spell.",
    "Straight talk—what’d the day do to you?",
    "Sweet or rowdy—your pick.",
    "Porch light on or off?",
    "You hungry or just hungry for trouble?",
    "You been good today, or do I need to fix that?"
  ]
};
const KEEPALIVE = [
  "I’m here. Lead and I’ll follow.",
  "Give me one more detail.",
  "Say it how you want it—I can work with that.",
  "Short and honest—I like that.",
  "I’m listening; make it specific."
];

let greetIndex = Number(localStorage.getItem("bb.greet-"+manParam)||0);
function nextGreet(){
  const arr = GREETS[manParam] || GREETS.blade;
  const line = arr[greetIndex % arr.length];
  greetIndex++; localStorage.setItem("bb.greet-"+manParam, String(greetIndex));
  return line;
}

/* -------------------- Erotic cue detection & coin popup -------------------- */
const EROTIC_CUE = /\b(lick|ride|rail|suck|go\s*down|eat\s*out|spank|choke|thrust|bend\s*me|doggystyle|deepthroat|cum|orgasm)\b/i;

function maybeShowCoins(){
  if (advBudget()<=0) $("#coinsPop").style.display="block";
}
$("#coinsNotNow").onclick = ()=> coinsPop.style.display="none";
document.querySelectorAll("#coinsPop .pack").forEach(p=>{
  p.addEventListener("click", ()=>{
    const n = Number(p.getAttribute("data-coins"));
    // Demo add coins locally; spend only when we actually send advanced replies
    addCoins(n);
    coinsPop.style.display="none";
    toast(`Demo: added ${n} coins`);
  });
});

/* -------------------- Talk to server (brain) -------------------- */
async function askBrain(userText, mode){
  const history = Array.from(log.querySelectorAll(".row")).slice(-40).map(r=>{
    const isMe = r.querySelector(".me");
    return (isMe? "user: " : "bot: ") + r.textContent.trim();
  }).join("\n");

  const res = await fetch("/api/brain", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ man:manParam, text:userText, mode, history })
  }).catch(()=>null);

  if (!res || !res.ok){
    return "I’m here, but the line’s noisy. Say it again?";
  }
  const data = await res.json().catch(()=>({reply:"…"}));
  return data.reply || "Say that once more for me.";
}

/* -------------------- Send flow -------------------- */
async function handleSend(){
  const text = input.value.trim();
  if (!text) return;

  // standards check
  if (breaksStandards(text)) { showStd(); return; }

  // post user
  row(escapeHtml(text), "me");
  input.value=""; userMsgCount++;

  // keep-alive line every 5 user messages
  if (userMsgCount % 5 === 0){
    row(`<em class="sys">${KEEPALIVE[(userMsgCount/5-1)%KEEPALIVE.length]}</em>`);
  }

  // erotic cue handling
  let mode = "pg";
  if (EROTIC_CUE.test(text)){
    if (advBudget()<=0){
      maybeShowCoins();
      row(`<em class="sys">We’ll keep it PG-13 until coins unlock advanced chat.</em>`);
      mode = "pg";
    }else{
      mode = "adv";
    }
  }else if (advBudget()>0){
    mode = "adv"; // stay advanced while budget lasts
  }

  // ask brain
  const reply = await askBrain(text, mode);

  // spend budget only when we actually generated advanced reply
  if (mode === "adv"){
    const before = advBudget();
    const after = consumeBudget(1);
    if (before % 25 === before - after){ // just started a new 25-pack
      row(`<em class="sys">Spent 1 coin — unlocked 25 hotter replies.</em>`);
    }
    if (after<=0){ row(`<em class="sys">Your 25 hot replies are used—back to PG-13.</em>`); }
  }

  row(escapeHtml(reply), "ai");
}

function escapeHtml(s){ return s.replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;', "'":'&#39;' }[m])); }

/* -------------------- Init -------------------- */
(function init(){
  row(`<strong>${guy.name}:</strong> ${nextGreet()}`, "ai");
  startTimer();
  input.addEventListener("keydown", (e)=>{ if(e.key==="Enter"){ handleSend(); }});
  sendBtn.addEventListener("click", handleSend);
})();
</script>
</body>
</html>
