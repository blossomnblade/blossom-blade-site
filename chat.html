<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Blossom & Blade â€” Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    :root { --bg:#0b0b0f; --panel:rgba(15,15,22,.72); --border:#ffffff1a; --fg:#f7f7fb; --accent:#ff2f86; }
    html,body{margin:0;padding:0;min-height:100%;background:var(--bg);color:var(--fg);font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial}
    .wrap{min-height:100dvh;display:grid;grid-template-rows:auto 1fr auto}
    header{position:relative;padding:18px 20px;display:flex;align-items:center;justify-content:center}
    header h1{margin:0;font-weight:800}
    .badge{position:absolute;right:16px;top:12px;font-size:12px;background:#111;border:1px solid var(--border);border-radius:999px;padding:6px 10px}
    .stage{display:grid;place-items:center;padding:14px;background:linear-gradient(160deg,#11131a 0%,#0b0b0f 100%)}
    .chat-panel{width:min(1024px,94vw);height:min(70vh,74dvh);background:var(--panel);border:1px solid var(--border);border-radius:20px;padding:18px;overflow:auto;box-shadow:0 10px 30px rgba(0,0,0,.45)}
    .msg{max-width:76%;margin:14px 0;padding:12px 16px;border-radius:12px;line-height:1.45}
    .msg-bot{background:#151520;border:1px solid var(--border)}
    .msg-user{margin-left:auto;background:var(--accent);color:#111;font-weight:700}
    .typing{opacity:.7;font-style:italic}
    .composer{display:flex;gap:12px;padding:14px;position:sticky;bottom:0;background:linear-gradient(180deg,rgba(11,11,15,0) 0%,rgba(11,11,15,.75) 30%,rgba(11,11,15,1) 100%)}
    #user-input{flex:1;padding:14px 16px;border-radius:999px;border:1px solid #fff2;background:#0e0e14;color:#f7f7fb;outline:none}
    #send-btn{padding:12px 18px;border-radius:16px;border:0;background:var(--accent);color:#111;font-weight:800;cursor:pointer;box-shadow:0 6px 20px rgba(255,47,134,.25)}
    @media (max-width:480px){.msg{max-width:88%}.chat-panel{height:60dvh}}
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Blossom & Blade â€” Chat</h1>
    <div class="badge">Adults 18+ only</div>
  </header>

  <main class="stage" id="stage">
    <div id="chat" class="chat-panel" aria-live="polite"></div>
  </main>

  <footer class="composer">
    <input id="user-input" type="text" placeholder="Say hiâ€¦" autocomplete="off"/>
    <button id="send-btn">Send</button>
  </footer>
</div>

<!-- Prompts + Client engine -->
<script src="/scripts/prompts.js"></script>
<script src="/scripts/chat.js"></script>

<!-- Background loader that matches YOUR filenames exactly -->
<script>
(function(){
  function qs(n){ try{ return (new URLSearchParams(location.search)).get(n); }catch(e){ return null; } }
  var man=(qs('man')||qs('g')||'blade').toLowerCase();
  var sub=(qs('sub')||'night').toLowerCase(); // default to night for vibe
  var override=qs('bg');
  var stage=document.getElementById('stage');

  // ðŸ”¥ These match your repo (/images):
  var MAP={
    blade:     { day:'/images/blade-woods.jpg',        night:'/images/blade-woods.jpg' },
    dylan:     { day:'/images/dylan-garage.jpg',       night:'/images/dylan-garage.jpg' },
    jesse:     { day:'/images/jesse-books-day.jpg',    night:'/images/jesse-bull-night.jpg' },
    alexander: { day:'/images/bg_alexander_boardroom.jpg', night:'/images/bg_alexander_boardroom.jpg' },
    silas:     { day:'/images/bg_silas_stage.jpg',     night:'/images/bg_silas_stage.jpg' },
    grayson:   { day:'/images/grayson-bg.jpg',         night:'/images/grayson-bg.jpg' }
  };
  // Site-wide fallbacks you already have:
  var SUBF   ={ day:'/images/bg_dark_romance.jpg', night:'/images/gothic-bg.jpg' };
  var GLOBAL ='/images/gothic-bg.jpg';

  var guesses=[];
  if(override) guesses.push(override);
  if(MAP[man] && MAP[man][sub]) guesses.push(MAP[man][sub]);
  guesses.push('/images/'+man+'-'+sub+'.jpg','/images/'+man+'.jpg');
  if(SUBF[sub]) guesses.push(SUBF[sub]);
  guesses.push(GLOBAL);

  function setBG(src){ stage.style.background="url('"+src+"') center/cover fixed no-repeat"; }
  (function next(i){
    if(i>=guesses.length) return;
    var src=guesses[i], img=new Image();
    img.onload=function(){ setBG(src); };
    img.onerror=function(){ next(i+1); };
    img.src=src;
  })(0);
})();
</script>
</body>
</html>
